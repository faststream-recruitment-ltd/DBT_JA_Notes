{{ config(
    indexes = [{'columns':['_airbyte_emitted_at'],'type':'btree'}],
    unique_key = '_airbyte_ab_id',
    schema = "_airbyte_public",
    tags = [ "top-level-intermediate" ]
) }}
-- SQL model to cast each column to its adequate SQL type converted from the JSON schema type
-- depends_on: {{ ref('notes_ab1') }}
select
    attachments,
    cast(attachmentId as {{ dbt_utils.type_string() }}) as attachmentId,
    cast(attachment_createdAt as timestamp) as attachment_createdAt,
    cast(attachment_fileType as {{ dbt_utils.type_string() }}) as attachment_fileType,
    cast(attachment_fileName as {{ dbt_utils.type_string() }}) as attachment_fileName,
    cast(subject as {{ dbt_utils.type_string() }}) as subject,
    jobs,
    cast(jobId as {{ dbt_utils.type_bigint() }}) as jobId,
    cast(jobs_company_name as {{ dbt_utils.type_string() }}) as jobs_company_name,
    cast(jobs_companyId as {{ dbt_utils.type_bigint() }}) as jobs_companyId,
    cast(jobtitle as {{ dbt_utils.type_string() }}) as jobtitle,
    cast(noteid as {{ dbt_utils.type_string() }}) as noteid,
    placements,
    cast(placementId as {{ dbt_utils.type_bigint() }}) as placementId,
    cast(placement_jobId as {{ dbt_utils.type_bigint() }}) as placement_jobId,    
    cast(placement_jobTitle as {{ dbt_utils.type_string() }}) as placement_jobTitle,
    cast(placement_company as {{ dbt_utils.type_string() }}) as placement_company,
    cast(placement_companyId as {{ dbt_utils.type_bigint() }}) as placement_companyId,
    cast(placement_contactId as {{ dbt_utils.type_bigint() }}) as placement_contactId,
    cast(placement_contact_firstName as {{ dbt_utils.type_string() }}) as placement_contact_firstName,
    cast(placement_contact_lastName as {{ dbt_utils.type_string() }}) as placement_contact_lastName,
    cast(placement_candidateId as {{ dbt_utils.type_bigint() }}) as placement_candidateId,
    cast(placement_firstName as {{ dbt_utils.type_string() }}) as placement_firstName,
    cast(placement_lastName as {{ dbt_utils.type_string() }}) as placement_lastName,    
    cast({{ adapter.quote('source') }} as {{ dbt_utils.type_string() }}) as {{ adapter.quote('source') }},
    cast({{ adapter.quote('type') }} as {{ dbt_utils.type_string() }}) as {{ adapter.quote('type') }},
    cast(reference as {{ dbt_utils.type_string() }}) as reference,
    cast(createdat as timestamp) as createdat,
    cast(updatedat as timestamp) as updatedat,
    candidates,
    cast(candidateid as {{ dbt_utils.type_bigint() }}) as candidateid,
    cast(candidate_email as {{ dbt_utils.type_string() }}) as candidate_email,
    cast(candidate_firstName as {{ dbt_utils.type_string() }}) as candidate_firstName,
    cast(candidate_lastName as {{ dbt_utils.type_string() }}) as candidate_lastName,    
    companies,
    cast(companyId as {{ dbt_utils.type_bigint() }}) as companyId,
    cast(company_name as {{ dbt_utils.type_string() }}) as company_name,
    cast(createdby as {{ type_json() }}) as createdby,
    cast(createdBy_userId as {{ dbt_utils.type_bigint() }}) as createdBy_userId,
    cast(createdBy_email as {{ dbt_utils.type_string() }}) as createdBy_email,
    cast(createdBy_firstName as {{ dbt_utils.type_string() }}) as createdBy_firstName,
    cast(createdBy_lastName as {{ dbt_utils.type_string() }}) as createdBy_lastName,
    cast(createdBy_deleted as {{ dbt_utils.type_string() }}) as createdBy_deleted,
    cast({{ adapter.quote('text') }} as {{ dbt_utils.type_string() }}) as {{ adapter.quote('text') }},
    contacts,
    cast(contactId as {{ dbt_utils.type_bigint() }}) as contactId,
    cast(contact_firstName as {{ dbt_utils.type_string() }}) as contact_firstName,
    cast(contact_lastName as {{ dbt_utils.type_string() }}) as contact_lastName,
    applications,
    cast(applicationId as {{ dbt_utils.type_bigint() }}) as applicationId,
    cast(application_jobId as {{ dbt_utils.type_bigint() }}) as application_jobId,    
    cast(application_jobTitle as {{ dbt_utils.type_string() }}) as application_jobTitle,
    cast(application_company as {{ dbt_utils.type_string() }}) as application_company,
    cast(application_companyId as {{ dbt_utils.type_bigint() }}) as application_companyId,
    cast(application_contactId as {{ dbt_utils.type_bigint() }}) as application_contactId,
    cast(application_contact_firstName as {{ dbt_utils.type_string() }}) as application_contact_firstName,
    cast(application_contact_lastName as {{ dbt_utils.type_string() }}) as application_contact_lastName,    
    _airbyte_ab_id,
    _airbyte_emitted_at,
    {{ current_timestamp() }} as _airbyte_normalized_at
from {{ ref('notes_ab1') }}
-- notes
where 1 = 1
{{ incremental_clause('_airbyte_emitted_at', this) }}

